<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/style.css"> 
    <link rel="icon" type="image/x-icon" href="./icons/fisioVR02.ico">

    <nav>
        <h4>FisioVR</h4>
        <ul class="menu">
            <!--<li><a href="" id="fecharJanela">Fechar janela</a></li>-->
        </ul>
    </nav>
    <title>Exercicios</title>
</head>

<body>
    <main class="main">
        <div class="section">
            <form class="form" id="form">
                <select name="exercicio" id="exercicio" required="required">
                    <option value="" src="">Escolha o exercício</option>
                    <option value="Elevação Lateral de Ombros">Elevação Lateral de Ombros</option>
                    <option value="Desenvolvimento de Ombros" src="">Desenvolvimento de Ombros</option>
                    <option value="Estocada Lateral" src="">Estocada Lateral</option>
                    <option value="Agachamento" src="">Agachamento</option>
                    <option value="Agachamento Sumô" src="">Agachamento Sumô</option>
                    <option value="Elevação Lateral de Pernas" src="">Elevação Lateral de Pernas</option>
                </select>
                <div>
                    <label>Número de Séries:</label>
                    <input type="text" id="sets" value="1">
                </div>
                <div>
                    <label>Número de Repetições:</label>
                    <input type="text" id="reps" value="5">
                </div>
                <div>
                    <label>Tempo de Descanso:</label>
                    <input type="text" id="rest" value="3">
                </div>
                <div>
                    <label>Ângulos Concêntricos:</label>
                    <input type="text" id="concentric">
                    <span id="membros-concentricos"></span>
                </div>
                <br>
                <div>
                    <label>Ângulos Excêntricos:</label>
                    <input type="text" id="excentric">
                    <span id="membros-excentricos"></span>
                </div>
                <button class="botao" id="start">Iniciar</button>
            </form>
        </div>
        <div class="show-gif">
            <img id="gif" src="#" alt="">
        </div>
    </main>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>   
    <script>
        document.getElementById('start').addEventListener("click", function(event){
            event.preventDefault();
            var frm = document.getElementById('form');
            var vname = document.getElementById('exercicio').value;
            var vsets = parseInt(document.getElementById('sets').value);
            var vreps = parseInt(document.getElementById('reps').value);
            var vrest = parseInt(document.getElementById('rest').value);
            var vconcentric = JSON.parse(document.getElementById('concentric').value);
            var vexcentric = JSON.parse(document.getElementById('excentric').value);

            let exercicio = {
                name: vname,
                sets: vsets,
                leftReps: vreps,
                rightReps: vreps,
                rest: vrest,
                concentric: vconcentric,
                eccentric: vexcentric,
                margin: 10
            }
            console.log(btoa(JSON.stringify(exercicio)));
            var criptExe = btoa(JSON.stringify(exercicio));
            var valid = 0;

            for(var i=0; i<criptExe.length; i++){
                valid += criptExe[i].charCodeAt(0);
            }
            console.log(valid);

            open(`https://avrgroup.github.io/FisioVR/?exe=${criptExe}&?eval=${valid}`);
        });

        const exercicios = [
            {
                nome: "Elevação Lateral de Ombros",
                angulos_concentricos: {rightShoulder:8, rightElbow:175},
                angulos_excentricos: {rightShoulder:90, rightElbow:175},
                caminho_demonstracao: './icons/gifs/ombros-elevacao-lateral-de-ombros.webp'
            },
            {
                nome: "Desenvolvimento de Ombros",
                angulos_concentricos: {rightElbow:165,rightShoulder:165},
                angulos_excentricos: {rightElbow:90,rightShoulder:90},
                caminho_demonstracao: './icons/gifs/desenvolvimento-para-ombros-com-halteres.webp'
            },
            {
                nome: "Estocada Lateral",
                angulos_concentricos: {rightHip:33,rightKnee:115,leftHip:30,leftKnee:170},
                angulos_excentricos: {rightHip:20,rightKnee:165,leftHip:20,leftKnee:165},
                caminho_demonstracao: './icons/gifs/pernas-agachamento-lateral-gif.webp'
            },
            {
                nome: "Agachamento",
                angulos_concentricos: {rightKnee:115,rightHip:45},
                angulos_excentricos: {rightKnee:165,rightHip:15},
                caminho_demonstracao: './icons/gifs/agachamento.webp'
            },
            {
                nome: "Agachamento Sumô",
                angulos_concentricos: {rightKnee:150,rightHip:15},
                angulos_excentricos: {rightKnee:180,rightHip:15},
                caminho_demonstracao: './icons/gifs/agachamento-sumo.webp'
            },
            {
                nome: "Elevação Lateral de Pernas",
                angulos_concentricos: {rightHip:45},
                angulos_excentricos: {rightHip:15},
                caminho_demonstracao: './icons/gifs/elevacao-lateral-de-pernas.webp'
            }
        ]

        function traduzir(txt) {

        }

        document.getElementById('exercicio').addEventListener('change', function handleChange(event){
            const img  = document.getElementById('gif');
            const concentric = document.getElementById('concentric');
            const excentric = document.getElementById('excentric');

            if (event.target.value === ''){
                img.src = '';
            }
            else {
                let element = exercicios.find(exercicio => exercicio.nome === event.target.value);
                img.src = element.caminho_demonstracao;
                concentric.value = JSON.stringify(element.angulos_concentricos);
                excentric.value =JSON.stringify( element.angulos_excentricos);
                document.getElementById("membros-concentricos").innerText  = Object.keys(element.angulos_concentricos).join(', ')
                document.getElementById("membros-excentricos").innerText  = Object.keys(element.angulos_concentricos).join(', ')
                // trocar keys por values

            }
            /*if (event.target.value === 'Elevação Lateral de Ombros'){
                img.src = './icons/gifs/ombros-elevacao-lateral-de-ombros.webp';
                concentric.value = '{"rightShoulder":8,"rightElbow":175}';
                excentric.value = '{"rightShoulder":90,"rightElbow":175}';
            }
            if (event.target.value === 'Desenvolvimento de Ombros'){
                img.src = './icons/gifs/desenvolvimento-para-ombros-com-halteres.webp';
                concentric.value = '{"rightElbow":165,"rightShoulder":165}';
                excentric.value = '{"rightElbow":90,"rightShoulder":90}';
            }
            if (event.target.value === 'Estocada Lateral'){
                img.src = './icons/gifs/pernas-agachamento-lateral-gif.webp';
                concentric.value = '{"rightHip":33,"rightKnee":115,"leftHip":30,"leftKnee":170}';
                excentric.value = '{"rightHip":20,"rightKnee":165,"leftHip":20,"leftKnee":165}';
            }
            if (event.target.value === 'Agachamento'){
                img.src = './icons/gifs/agachamento.webp';
                concentric.value = '{"rightKnee":115,"rightHip":45}';
                excentric.value = '{"rightKnee":165,"rightHip":15}';
            }
            if (event.target.value === 'Agachamento Sumô'){
                img.src = './icons/gifs/agachamento-sumo.webp';
                concentric.value = '{"rightKnee":150,"rightHip":15}';
                excentric.value = '{"rightKnee":180,"rightHip":15}';
            }
            if (event.target.value === 'Elevação Lateral de Pernas'){
                img.src = './icons/gifs/elevacao-lateral-de-pernas.webp';
                concentric.value = '{"rightHip":45}';
                excentric.value = '{"rightHip":15}';
            }*/
        });

        //função para fechar a janela
        /*function fecharJanela(){
                
            window.close();
        }*/
    </script>
</body>

</html>